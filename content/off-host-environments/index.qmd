---
title: Identify images used in off-host execution
execute:
  eval: false
---

This recipe shows how to find what images are used by content deployed to a Posit Connect server.
Use this recipe only when your Connect installation uses the off-host
execution model, where content is executed in containers using Kubernetes.

The document uses the **[`GET /v1/content`](../../api/#get-/v1/content)** endpoint to obtain information about content.
This API call returns every content item visible to your [API key](../../user/api-keys/index.md).
Content reported with a missing value is either incomplete or static (needing no runtime).

To see all environments available on your server, you can query the **[`GET /v1/environments`](../../api/#get-/v1/environments)** endpoint.

### See which images are used

::: {.panel-tabset group="language"}
## Python

```{python}
import polars as pl
from posit import connect

con = connect.Client()
df = pl.DataFrame(con.content.find(), infer_schema_length=None)
df.group_by("image_name").count().sort("count", descending=True)
```

## R

```{r}
library(connectapi)
library(dplyr)

# Find all content, group by image_name and count,
# sorting by most frequently used image

connect() |>
  get_content() |>
  count(image_name) |>
  arrange(desc(n))
```

:::

### Find all content using an image

This recipe returns a list of GUIDs for content using a given image.

::: {.panel-tabset group="language"}
## Python

```{python}
from posit import connect

con = connect.Client()

# Change this to whatever image_name you want to find
image = "ghcr.io/rstudio/content-pro:r4.1.3-py3.10.4-bionic"

[c.guid for c in con.content.find() if c.image_name == image]
```

## R

```{r}
library(connectapi)
library(dplyr)

# Change this to whatever image_name you want to find
image <- "ghcr.io/rstudio/content-pro:r4.1.3-py3.10.4-bionic"

connect() |>
  get_content() |>
  filter(image_name == image) |>
  pull(guid)
```

:::

